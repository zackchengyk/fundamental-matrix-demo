var bt=Object.defineProperty,ft=Object.defineProperties;var gt=Object.getOwnPropertyDescriptors;var Xe=Object.getOwnPropertySymbols;var xt=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable;var $e=(t,i,a)=>i in t?bt(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,$=(t,i)=>{for(var a in i||(i={}))xt.call(i,a)&&$e(t,a,i[a]);if(Xe)for(var a of Xe(i))yt.call(i,a)&&$e(t,a,i[a]);return t},G=(t,i)=>ft(t,gt(i));import{M as ae,j as Fe,R as Z,a as ue,V as k,Q as wt,S as vt,I as Nt,b as kt,c as Pt,P as Mt,C as Tt,L as Rt,B as Ct,d as Dt,W as At,O as St,A as Ft,e as Le,G as Lt,r as d,f as Ge,g as It}from"./vendor.0237ff3e.js";const qt=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function a(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerpolicy&&(c.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?c.credentials="include":r.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=a(r);fetch(r.href,c)}};qt();var ie;(function(t){t[t.nothing=0]="nothing",t[t.setPointToOrigin=1]="setPointToOrigin"})(ie||(ie={}));var s;(function(t){t[t.nothing=0]="nothing",t[t.setLookPositionToOrigin=1]="setLookPositionToOrigin",t[t.setRotationToIdentity=2]="setRotationToIdentity",t[t.resetTransforms=3]="resetTransforms",t[t.useStandardViewX=4]="useStandardViewX",t[t.useStandardViewY=5]="useStandardViewY",t[t.useStandardViewZ=6]="useStandardViewZ",t[t.setRotationToMatchC1=7]="setRotationToMatchC1",t[t.setRotationToMatchC2=8]="setRotationToMatchC2",t[t.setPositionToMatchC1=9]="setPositionToMatchC1",t[t.setPositionToMatchC2=10]="setPositionToMatchC2"})(s||(s={}));const zt=5,Ht=/^(-?)0(\.)/;function P(t){if(typeof t=="string")return t;if(Math.abs(t)<1e-4)return"0";const a=(Math.round(t*1e3)/1e3).toString().replace(Ht,"$1$2"),o=Math.max(a.indexOf(".")+3,zt);return a.length>o?a.slice(0,o-1)+"\u2026":a.slice(0,o)}function jt(t){return new ae().fromArray([0,-t.z,t.y,t.z,0,-t.x,-t.y,t.x,0])}function Ye(t){const i=t.elements;return new ae().fromArray([i[0],i[1],i[2],i[4],i[5],i[6],i[8],i[9],-i[10],0,0,0])}function _e(t,i){return t.length===i.length&&t.every((a,o)=>a===i[o])}function Et(t,i,a){return Math.abs(t.x-i.x)<a&&Math.abs(t.y-i.y)<a&&Math.abs(t.z-i.z)<a&&Math.abs(t.w-i.w)<a}const e=Fe.exports.jsx,n=Fe.exports.jsxs,Ue=Fe.exports.Fragment;function me({label:t,array:i,className:a,style:o}){return n("div",{className:"matrix "+a,children:[e("div",{className:"matrix-label",children:t}),e("div",{className:"matrix-elements",style:o,children:i.map((r,c)=>e("span",{className:"limit-dp",children:P(r)},c))})]})}function Bt({label:t,matrix:i,className:a}){return e(me,{label:t,array:i.elements,className:a,style:{gridTemplate:"repeat(4, 1fr) / repeat(4, auto)"}})}function Wt(t,i){return t.label===i.label&&t.matrix.equals(i.matrix)}const B=Z.memo(Bt,Wt);function Ot({label:t,vector:i,className:a}){return e(me,{label:t,array:i.toArray(),className:a,style:{gridTemplate:"repeat(4, 1fr) / auto"}})}function Vt(t,i){return t.label===i.label&&t.vector.equals(i.vector)}const Y=Z.memo(Ot,Vt);function Kt({label:t,matrix:i,className:a}){const o=i.elements,r=o.length===16?[o[0],o[1],o[2],o[4],o[5],o[6],o[8],o[9],o[10]]:o;return e(me,{label:t,array:r,className:a,style:{gridTemplate:"repeat(3, 1fr) / repeat(3, auto)"}})}function Xt(t,i){return t.label===i.label&&_e(t.matrix.elements,i.matrix.elements)}const y=Z.memo(Kt,Xt);function $t({label:t,vector:i,className:a}){const o=i.toArray(),r=o.length===4?[o[0],o[1],o[2]]:o;return e(me,{label:t,array:r,className:a,style:{gridTemplate:"repeat(3, 1fr) / auto"}})}function Gt(t,i){return t.label===i.label&&_e(t.vector.toArray(),i.vector.toArray())}const b=Z.memo($t,Gt);function Yt({label:t,matrix:i,className:a}){const o=i.elements,r=[o[0],o[1],o[2],o[4],o[5],o[6],o[8],o[9],o[10],o[12],o[13],o[14]];return e(me,{label:t,array:r,className:a,style:{gridTemplate:"repeat(3, 1fr) / repeat(4, auto)"}})}function _t(t,i){return t.label===i.label&&t.matrix.equals(i.matrix)}const z=Z.memo(Yt,_t);var W;(function(t){t[t.anything=0]="anything",t[t.maintainDirection=1]="maintainDirection",t[t.exactToLookAt=2]="exactToLookAt",t[t.slerpToLookAt=3]="slerpToLookAt"})(W||(W={}));const Ze=1/16,be=new k,Je=new ue,Ie=new wt;function Ut(t){qe(t,t.camera.position),Ce(t,t.orbitControls.target)}function qe(t,i,a){a!=null&&(t.lookDirUpdateMode=a),t.targetPosition.copy(i)}function Ce(t,i,a){a!=null&&(t.lookDirUpdateMode=a),t.orbitControls.target.copy(i),t.targetLookPosition.copy(i)}function Zt(t,i){for(const a of i.cameraData){const o=a.container.clientWidth,r=a.container.clientHeight;a.camera.aspect=o/r,a.camera.updateProjectionMatrix(),a.renderer.setSize(o,r)}}function Jt(t,i){const a=(t-i.prevTime)/1e3;i.prevTime=t;const o=i.pointPosition;i.isMoving?(o.y=2+Math.sin(t*.0015)*2,i.fixedPointPosition=null):i.fixedPointPosition!=null&&o.copy(i.fixedPointPosition);for(let r=0;r<3;r++){const c=i.cameraData[r],p=c.camera,D=c.line,N=c.orbitControls;let S=!1,l=!1;const m=c.targetPosition;be.subVectors(p.position,m);const R=be.length();if(R>1e-4){S=!0;const f=1-Math.pow(Ze,a);p.position.lerp(m,f),p.updateProjectionMatrix(),(c.lookDirUpdateMode===0||c.lookDirUpdateMode===2)&&(c.lookDirUpdateMode=R>.5?2:3)}else c.lookDirUpdateMode=3;switch(c.lookDirUpdateMode){case 1:break;case 2:{N.target.copy(c.targetLookPosition),p.lookAt(c.targetLookPosition);break}case 3:{if(be.copy(c.targetLookPosition).add(p.position).sub(c.targetPosition),Je.lookAt(p.position,be,p.up),Ie.setFromRotationMatrix(Je),!Et(p.quaternion,Ie,1e-4)){l=!0;const f=1-Math.pow(Ze,a);c.orbitControls.target.copy(be),p.quaternion.slerp(Ie,f),p.updateProjectionMatrix()}break}}!S&&!l&&N.update();const v=D.geometry.attributes.position.array,H=o.clone().sub(p.position),X=p.position.clone().add(H.clone().multiplyScalar(-1e3)),M=p.position.clone().add(H.clone().multiplyScalar(1e3));v[0]=X.x,v[1]=X.y,v[2]=X.z,v[3]=M.x,v[4]=M.y,v[5]=M.z,D.geometry.attributes.position.needsUpdate=!0}}function Qe(t,i,a){i.nextFrameReq=requestAnimationFrame(o=>Qe(o,i)),Zt(t,i),Jt(t,i),Qt(i)}function Qt(t){en(t),tn(t)}function en(t){t.cameraData.forEach(({renderer:i,camera:a})=>{i.render(t.scene,a)})}function tn(t){t.updateGUIFunction(t)}const nn=6010245,an=33511;function on(t){const i=new vt,a=new Nt(.25),o=new kt({color:15257272}),r=new Pt(a,o);r.layers.enableAll(),i.add(r);const c=[];for(let l=0;l<t.length;l++){const m=t[l].container,R=t[l].canvas,v=m.clientWidth,H=m.clientHeight,X=v/H,M=new Mt(40,X,1e-4,1e4);M.position.fromArray(et(l)),M.layers.set(l);const f=new Tt(M);f.layers.disableAll(),f.layers.enable(2),l!==2&&i.add(f);const O=new Rt({color:l?nn:an}),F=[M.position,r.position],j=new Ct().setFromPoints(F),C=new Dt(j,O);C.frustumCulled=!1,C.layers.enableAll(),C.layers.disable(l),C.visible=!1,l!==2&&i.add(C);const A=new At({canvas:R,alpha:!0});A.setPixelRatio(window.devicePixelRatio),A.setClearColor(16777215,0),A.setSize(v,H);const V=new St(M,m),K={container:m,canvas:R,camera:M,renderer:A,cameraHelper:f,line:C,orbitControls:V,targetPosition:new k().copy(M.position),targetLookPosition:new k,lookDirUpdateMode:W.slerpToLookAt,extrinsicMatrix:M.matrixWorldInverse,intrinsicMatrix:M.projectionMatrix};V.addEventListener("change",()=>Ut(K)),c.push(K)}const p=new Ft(10);p.setColors(new Le(16711680),new Le(65280),new Le(255)),p.layers.enableAll(),i.add(p);const D=new Lt(5,5,16711680,8680812);D.layers.enableAll(),i.add(D);let N="dummy";return N={isMoving:!1,modifierFunctions:{enableMovement(l){N.isMoving=l},setPointPosition(l){l!=null&&(N.fixedPointPosition=l.clone())},showFrustum(l,m){m?c[l].cameraHelper.layers.enableAll():(c[l].cameraHelper.layers.disableAll(),c[l].cameraHelper.layers.enable(2))},showEpipolarLines(l){c.forEach(({line:m})=>m.visible=l)},setPosition(l,m,R){qe(c[l],m,R)},setLookPosition(l,m){Ce(c[l],m,W.slerpToLookAt)},resetTransforms(l){qe(c[l],new k().fromArray(et(l)),W.slerpToLookAt),Ce(c[l],new k)},setRotationToIdentity:l=>{const m=c[l],R=m.camera,v=m.orbitControls.getDistance(),H=new k(R.position.x,R.position.y,R.position.z-v);Ce(m,H,W.slerpToLookAt)}},scene:i,pointPosition:r.position,fixedPointPosition:null,updateGUIFunction:l=>{},nextFrameReq:0,prevTime:0,cameraData:c},N}function et(t){switch(t){case 0:return[5,5,20];case 1:return[30,20,10];case 2:return[30,60,30];default:return[0,0,0]}}function rn(t,i,a,o,r,c){const p=on([{container:t,canvas:i},{container:a,canvas:o},{container:r,canvas:c}]);return p.nextFrameReq=requestAnimationFrame(D=>Qe(D,p)),p}function oe({x:t,y:i,className:a}){return e("div",{className:"target "+a,style:{transform:`translate(${-t*50}%, ${i*50}%) scale(0.04)`}})}function ze(t,i,a){switch(a){case s.setLookPositionToOrigin:{t.modifierFunctions.setLookPosition(i,new k);break}case s.setRotationToIdentity:{t.modifierFunctions.setRotationToIdentity(i);break}case s.resetTransforms:{t.modifierFunctions.resetTransforms(i);break}case s.useStandardViewX:{t.modifierFunctions.setPosition(i,new k(10,0,0),W.exactToLookAt),t.modifierFunctions.setLookPosition(i,new k);break}case s.useStandardViewY:{t.modifierFunctions.setPosition(i,new k(0,10,0),W.exactToLookAt),t.modifierFunctions.setLookPosition(i,new k);break}case s.useStandardViewZ:{t.modifierFunctions.setPosition(i,new k(0,0,10),W.exactToLookAt),t.modifierFunctions.setLookPosition(i,new k);break}case s.setRotationToMatchC1:{const o=t.cameraData[0].targetLookPosition.clone().sub(t.cameraData[0].camera.position).add(t.cameraData[i].camera.position);t.modifierFunctions.setLookPosition(i,o);break}case s.setRotationToMatchC2:{const o=t.cameraData[1].targetLookPosition.clone().sub(t.cameraData[1].camera.position).add(t.cameraData[i].camera.position);t.modifierFunctions.setLookPosition(i,o);break}case s.setPositionToMatchC1:{t.modifierFunctions.setPosition(i,t.cameraData[0].camera.position,W.maintainDirection);const o=t.cameraData[i].targetLookPosition.clone().add(t.cameraData[0].camera.position).sub(t.cameraData[i].camera.position);t.modifierFunctions.setLookPosition(i,o);break}case s.setPositionToMatchC2:{t.modifierFunctions.setPosition(i,t.cameraData[1].camera.position,W.maintainDirection);const o=t.cameraData[i].targetLookPosition.clone().add(t.cameraData[1].camera.position).sub(t.cameraData[i].camera.position);t.modifierFunctions.setLookPosition(i,o);break}}}const sn=Z.forwardRef(({startDragTop:t,startDragBot:i,x:a,xp:o,lFunction:r,lpFunction:c,setX:p,isMoving:D,setK:N,setM:S,setC1Pos:l,showC1Display:m,setKp:R,setMp:v,setC2Pos:H,showC2Display:X,showC3Display:M,otherThingsToShow:f,sceneCommand:O,setSceneCommand:F,c1Command:j,setC1Command:C,c2Command:A,setC2Command:V,c3Command:K,setC3Command:re},{demoWindowRef:fe,topRef:ge,botRef:J})=>{const g=d.exports.useRef(),L=d.exports.useRef(),xe=d.exports.useRef(),I=d.exports.useRef(),ye=d.exports.useRef(),we=d.exports.useRef(),ve=d.exports.useRef();d.exports.useEffect(()=>{if(!(O===ie.nothing||g.current==null)){switch(O){case ie.setPointToOrigin:g.current.modifierFunctions.setPointPosition(new k)}F(ie.nothing)}},[O]),d.exports.useEffect(()=>{j===s.nothing||g.current==null||(ze(g.current,0,j),C(s.nothing))},[j]),d.exports.useEffect(()=>{A===s.nothing||g.current==null||(ze(g.current,1,A),V(s.nothing))},[A]),d.exports.useEffect(()=>{K===s.nothing||g.current==null||(ze(g.current,2,K),re(s.nothing))},[K]),d.exports.useEffect(()=>{g.current!=null&&g.current.modifierFunctions.enableMovement(D)},[D]),d.exports.useEffect(()=>{g.current!=null&&g.current.modifierFunctions.showFrustum(0,f.c1Frustum)},[f.c1Frustum]),d.exports.useEffect(()=>{g.current!=null&&g.current.modifierFunctions.showFrustum(1,f.c2Frustum)},[f.c2Frustum]),d.exports.useEffect(()=>{g.current!=null&&g.current.modifierFunctions.showEpipolarLines(f.epipolarLines)},[f.epipolarLines]);function se(E){const Ne=new Ge(E.pointPosition.x,E.pointPosition.y,E.pointPosition.z,1);p(u=>Ne.equals(u)?u:Ne);const ke=Ye(E.cameraData[0].intrinsicMatrix.clone()),Pe=E.cameraData[0].extrinsicMatrix.clone(),ce=E.cameraData[0].camera.position.clone();N(u=>ke.equals(u)?u:ke),S(u=>Pe.equals(u)?u:Pe),l(u=>ce.equals(u)?u:ce);const Me=Ye(E.cameraData[1].intrinsicMatrix.clone()),ee=E.cameraData[1].extrinsicMatrix.clone(),le=E.cameraData[0].camera.position.clone();R(u=>Me.equals(u)?u:Me),v(u=>ee.equals(u)?u:ee),H(u=>ce.equals(u)?u:le)}d.exports.useEffect(()=>{g.current=rn(L.current,xe.current,I.current,ye.current,we.current,ve.current),g.current.updateGUIFunction=se,se(g.current)},[]);const Q={opacity:0,pointerEvents:"none"};return n("div",{id:"demo-window",ref:fe,children:[e("div",{className:"demo-panel",ref:ge,children:n("div",{className:"container",ref:L,style:m?{}:Q,children:[e("canvas",{className:"canvas",ref:xe}),f.c1PointPrediction?e(oe,{x:a.x,y:a.y,className:"blue"}):null,f.epipolarLinePredictions?n(Ue,{children:[e(oe,{x:-1,y:r(-1),className:"green"}),e(oe,{x:1,y:r(1),className:"green"})]}):null,e("div",{className:"container-label",children:"View From Camera 1 (c1)"})]})}),e("div",{id:"ns-resize-bar-top",onMouseDown:t}),e("div",{className:"demo-panel",children:n("div",{className:"container",ref:I,style:X?{}:Q,children:[e("canvas",{className:"canvas",ref:ye}),f.c2PointPrediction?e(oe,{x:o.x,y:o.y,className:"green"}):null,f.epipolarLinePredictions?n(Ue,{children:[e(oe,{x:-1,y:c(-1),className:"blue"}),e(oe,{x:1,y:c(1),className:"blue"})]}):null,e("div",{className:"container-label",children:"View From Camera 2 (c2)"})]})}),e("div",{id:"ns-resize-bar-bot",onMouseDown:i}),e("div",{className:"demo-panel",ref:J,children:n("div",{className:"container",ref:we,style:M?{}:Q,children:[e("canvas",{className:"canvas",ref:ve}),e("div",{className:"container-label",children:"View From Witness Camera"})]})})]})}),He=t=>{const i=d.exports.useRef(null),[a,o]=d.exports.useState(!1),r=c=>{var N;const[p]=c,D=((N=p.rootBounds)==null?void 0:N.top)||0;o(p.isIntersecting||p.boundingClientRect.top-D<0)};return d.exports.useEffect(()=>{const c=new IntersectionObserver(r,t);return i.current&&c.observe(i.current),()=>{i.current&&c.unobserve(i.current)}},[i,t]),[i,a]},w=Z.forwardRef(({initialCollapse:t=!1,children:i},a)=>{const[o,r]=d.exports.useState(t);return e("div",{className:"matrix-equation collapsible "+(o?"collapsed":""),onClick:()=>r(c=>!c),ref:a,children:i})}),cn=new ue().fromArray(["a","e","i",0,"b","f","j",0,"c","g","k",0,"d","h","l",0]),ln=new ae().fromArray(["fx",0,0,"s","fy",0,"u0","v0",1]),dn=new ue().fromArray(["r11","r21","r31",0,"r12","r22","r32",0,"r13","r23","r33",0,"tx","ty","tz",0]);function hn(){const[t,i]=d.exports.useState(new Ge),[a,o]=d.exports.useState(new ae),[r,c]=d.exports.useState(new ue),[p,D]=d.exports.useState(new k),N=t.clone().applyMatrix4(r),S=new k(N.x,N.y,N.z).applyMatrix3(a),l=S.clone().divideScalar(S.z),[m,R]=d.exports.useState(new ae),[v,H]=d.exports.useState(new ue),[X,M]=d.exports.useState(new k),f=t.clone().applyMatrix4(v),O=new k(f.x,f.y,f.z).applyMatrix3(m),F=O.clone().divideScalar(O.z),j=r.clone().invert(),C=v.clone().multiply(j),A=new ae().setFromMatrix4(C),V=new k().setFromMatrixColumn(C,3),K=jt(V),re=K.clone().multiply(A),fe=a.clone().invert(),ge=m.clone().invert().transpose(),J=ge.clone().multiply(re).multiply(fe),g=J.clone().transpose(),L=F.clone().applyMatrix3(g),xe=h=>(-L.z-L.x*h)/L.y,I=l.clone().applyMatrix3(J),ye=h=>(-I.z-I.x*h)/I.y,we=L.dot(l),ve=I.dot(F),se=d.exports.useRef(),Q={root:se.current,rootMargin:"0px",threshold:1},[E,Ne]=He(Q),[ke,Pe]=He(Q),[ce,Me]=He(Q),[ee,le]=d.exports.useState(!1),[u,_]=d.exports.useState({c1PointPrediction:!1,c2PointPrediction:!1,c1Frustum:!1,c2Frustum:!1,epipolarLines:!1,epipolarLinePredictions:!1}),[tt,je]=d.exports.useState(ie.nothing),[nt,x]=d.exports.useState(s.nothing),[it,q]=d.exports.useState(s.nothing),[at,Ee]=d.exports.useState(s.nothing),[de,ot]=d.exports.useState(!1),rt=de?"a source":"c1's",Be=de?"the source":"c1's",st=de?"a destination":"c2's",De=de?"the destination":"c2's",he=d.exports.useRef(null),T={demoWindowRef:d.exports.useRef(null),topRef:d.exports.useRef(null),botRef:d.exports.useRef(null)},[ct,We]=d.exports.useState(!1),[Te,Oe]=d.exports.useState(!1),[lt,Ve]=d.exports.useState(!1),[U,Ae]=d.exports.useState(null);function Re(h){he.current.style.cursor=h}function dt(){!he.current||(We(!0),Re("ew-resize"))}function ht(){!T.demoWindowRef.current||!T.topRef.current||!T.botRef.current||(Oe(!0),Ae([T.demoWindowRef.current.getBoundingClientRect(),T.topRef.current.getBoundingClientRect(),T.botRef.current.getBoundingClientRect()]),Re("ns-resize"))}function pt(){!T.demoWindowRef.current||!T.topRef.current||!T.botRef.current||(Ve(!0),Ae([T.demoWindowRef.current.getBoundingClientRect(),T.topRef.current.getBoundingClientRect(),T.botRef.current.getBoundingClientRect()]),Re("ns-resize"))}function Ke(){We(!1),Oe(!1),Ve(!1),Ae(null),Re("auto")}function ut(h){if(ct&&he.current){h.preventDefault();const te=he.current,ne=te.getBoundingClientRect(),pe=h.clientX-7-ne.left,Se=ne.right-h.clientX-8,mt=`${pe}fr 15px ${Se}fr`;te.style.gridTemplateColumns=mt;return}if((Te||lt)&&T.demoWindowRef.current&&T.topRef.current&&T.botRef.current&&U){h.preventDefault();let te=Math.max(Te?h.clientY-7-U[0].top:U[1].height,2),ne=Math.max(Te?U[2].height:U[0].bottom-h.clientY-8,2),pe=U[0].height-te-ne-30;pe<2&&(pe=2,Te?te=U[0].height-ne-32:ne=U[0].height-te-32);const Se=`${te}fr 15px ${pe}fr 15px ${ne}fr`;T.demoWindowRef.current.style.gridTemplateRows=Se;return}}return n("div",{className:"App",ref:he,onMouseUp:Ke,onMouseLeave:Ke,onMouseMove:ut,children:[e(sn,{ref:T,startDragTop:ht,startDragBot:pt,x:l,xp:F,lFunction:xe,lpFunction:ye,setX:i,isMoving:ee,setK:o,setM:c,setC1Pos:D,showC1Display:Ne,setKp:R,setMp:H,setC2Pos:M,showC2Display:Pe,showC3Display:Me,otherThingsToShow:u,sceneCommand:tt,setSceneCommand:je,c1Command:nt,setC1Command:x,c2Command:it,setC2Command:q,c3Command:at,setC3Command:Ee}),e("div",{id:"ew-resize-bar",onMouseDown:dt}),e("div",{id:"scroll-outer",children:e("div",{ref:se,children:n("div",{id:"scroll-inner",children:[e("h1",{className:"title-text",children:"CSCI 1430: Fundamental Matrix Demo"}),n("div",{className:"body-text",children:[e("p",{children:"Hello!"}),e("p",{children:"Welcome to the demo part of our camera geometry workshop :) "}),n("p",{children:["On this page, we'll walk through how to go from ",e("strong",{children:"camera matrices"})," to the ",e("strong",{children:"fundamental matrix"})," and ",e("strong",{children:"epipolar lines"}),"."]}),n("p",{children:["Camera (and epipolar) geometry can be challenging concepts to nail down, so ","if you have any questions, please approach our awesome TAs on Ed!"]})]}),e("h2",{id:"camera-matrices-recap",className:"title-text",children:"Camera Matrices (Recap)"}),e("div",{className:"body-text",children:n("p",{children:["In previous lectures, you learned that a pinhole camera can be described by its ",e("strong",{children:"projection"})," matrix, which is the product of its ",e("strong",{children:"intrinsic"})," and ",e("strong",{children:"extrinsic"})," matrices:"]})}),n(w,{children:[e(z,{label:"projection matrix",matrix:cn}),e("span",{className:"big",children:"="}),e(y,{label:"intrinsic matrix",matrix:ln}),e("span",{children:"*"}),e(z,{label:"extrinsic matrix",matrix:dn})]}),n("div",{className:"body-text",children:[n("p",{children:["Recall that the ",e("strong",{children:e("em",{children:"intrinsic"})})," matrix depends only on things ",e("em",{children:"intrinsic"})," to the camera, like its field of view."]}),n("p",{children:["Likewise, the ",e("strong",{children:e("em",{children:"extrinsic"})})," matrix depends only on the camera's ",e("em",{children:"extrinsic"})," properties: its rotation and position in space."]})]}),e("div",{className:"body-text",children:n("blockquote",{children:[n("p",{children:["Think:  ","using only the extrinsic matrix, can you determine the camera's ","position in world space? If yes, how?"]}),n("p",{children:["Hint:  ","it's not <tx,\xA0ty,\xA0tz>."]})]})}),e("h2",{id:"introducing-camera-1",className:"title-text",children:"Introducing: Camera 1"}),e("div",{className:"body-text",children:n("p",{children:["Now, let's look at an ",e("strong",{children:"interactive example"}),". Here, we've set up a scene with an object and a camera (we'll call this ",e("strong",{children:"camera 1"}),")."]})}),n(w,{ref:E,children:[e("span",{children:"Camera 1 has"}),e(y,{label:"intrinsic matrix, K",matrix:a}),e("span",{children:", "}),e(z,{label:"extrinsic matrix, M",matrix:r}),e("span",{children:", and"}),e(b,{label:"position",vector:p})]}),n("div",{className:"body-text",children:[n("p",{children:["Move the camera, and see how its intrinsic and extrinsic matrices change. ","You can click and drag with the left mouse button to rotate, click and drag ","with the right mouse button to pan, scroll to zoom, or click any of these "," buttons (they're a bit finicky, so you might have to click more than once):"]}),n("div",{children:[e("button",{className:"control-button",onClick:()=>x(s.setRotationToIdentity),children:"Set Rotation To Identity"}),e("button",{className:"control-button",onClick:()=>x(s.setLookPositionToOrigin),children:"Look At Origin"}),e("button",{className:"control-button",onClick:()=>x(s.resetTransforms),children:"Reset"})]}),n("div",{children:["Standard views: ",e("button",{className:"control-button",onClick:()=>x(s.useStandardViewX),children:"X Axis"}),e("button",{className:"control-button",onClick:()=>x(s.useStandardViewY),children:"Y Axis"}),e("button",{className:"control-button",onClick:()=>x(s.useStandardViewZ),children:"Z Axis"})]})]}),e("div",{className:"body-text",children:e("blockquote",{children:n("p",{children:["Notice how the right-most column of M changes when you rotate the camera, ","even if you don't change its position."]})})}),e("h2",{id:"projection-recap",className:"title-text",children:"Projection (Recap)"}),n("div",{className:"body-text",children:[n("p",{children:["If you've done part of the written component of HW3, you might already have ",e("strong",{children:"projected"})," 3D points in world space onto a 2D image plane. ","If not, that's okay! We'll briefly recap the basic principles here :)"]}),n("p",{children:["Using camera 1 as an example, let's project the 3D point located at ",e("strong",{children:`<${P(t.x)},\xA0${P(t.y)},\xA0${P(t.z)}>`})," onto our image plane."]})]}),n(w,{children:[e(y,{label:"intrinsic matrix, K",matrix:a}),e("span",{children:"*"}),e(z,{label:"extrinsic matrix, M",matrix:r}),e("span",{children:"*"}),e(Y,{label:"world coord, X",vector:t}),e("span",{className:"big",children:"="}),e(b,{label:"result",vector:S}),e("span",{className:"big",children:"="}),e("span",{className:"limit-dp",children:P(S.z)}),e(b,{label:"image coord, x",vector:l,className:"blue"})]}),n("div",{className:"body-text",children:[n("p",{children:["This equation may seem scary, but it's lot simpler when you recall the steps for projection: ",e("br",{}),"1. Multiply K * M * X to get a 3x1 result",e("br",{}),"2. Then, divide that result by its z component",e("br",{}),"3. Finally, the result's ",e("strong",{className:"blue",children:"x and y values"})," give the point's normalized 2D image coordinates."]}),n("p",{children:["Now that we've calculated where the point should appear on the image plane, ","let's see if our prediction is correct. Click the button below to show a ",e("strong",{className:"blue",children:"marker"})," on the image: "]}),e("div",{children:e("button",{className:"control-button",onClick:()=>_(h=>G($({},h),{c1PointPrediction:!h.c1PointPrediction})),children:u.c1PointPrediction?"Hide Camera 1's Point Prediction":"Show Camera 1's Point Prediction"})})]}),n("div",{className:"body-text",children:[n("p",{children:["Try moving the camera around again! Or, click the button below to make the 3D point ",ee?"stop moving":"start moving",":"]}),e("div",{children:e("button",{className:"control-button",onClick:()=>le(h=>!h),children:ee?"Stop Moving":"Start Moving"})})]}),e("div",{className:"body-text",children:n("blockquote",{children:[n("p",{children:["Think:  ","why are x and y axes flipped, resulting in <1,\xA01> being at the bottom left?"]}),n("p",{children:["Hint 1:  ","in our ",e("em",{children:"result"}),", z is +1. If the camera looks in the \u2011z direction, ","where is the image plane relative to the camera center?"]}),n("p",{children:["Hint 2:  ",'have you ever been told that the images on your retinas (in your eyes) are "inverted"?']})]})}),e("h2",{id:"introducing-camera-2",className:"title-text",children:"Introducing: Camera 2"}),e("div",{className:"body-text",children:n("p",{children:["Now that we're through the recaps, it's finally time to talk about ",e("strong",{children:"stereo camera pairs"}),". For that, let's introduce ",e("strong",{children:"camera 2"}),"!"]})}),n(w,{ref:ke,children:[e("span",{children:"Camera 2 has"}),e(y,{label:"intrinsic matrix, Kp",matrix:m}),e("span",{children:", "}),e(z,{label:"extrinsic matrix, Mp",matrix:v}),e("span",{children:", and"}),e(b,{label:"position",vector:X})]}),e("div",{className:"body-text",children:n("p",{children:["Just like we did with camera 1, we can project the 3D point located at ",e("strong",{children:`<${P(t.x)},\xA0${P(t.y)},\xA0${P(t.z)}>`})," onto camera 2's image plane:"]})}),n(w,{children:[e(y,{label:"intrinsic matrix, K'",matrix:m}),e("span",{children:"*"}),e(z,{label:"extrinsic matrix, M'",matrix:v}),e("span",{children:"*"}),e(Y,{label:"world coord, X",vector:t}),e("span",{className:"big",children:"="}),e(b,{label:"result",vector:O}),e("span",{className:"big",children:"="}),e("span",{className:"limit-dp",children:P(O.z)}),e(b,{label:"image coord, x'",vector:F,className:"green"})]}),n("div",{className:"body-text",children:[e("div",{children:e("button",{className:"control-button",onClick:()=>_(h=>G($({},h),{c2PointPrediction:!h.c2PointPrediction})),children:u.c2PointPrediction?"Hide Camera 2's Point Prediction":"Show Camera 2's Point Prediction"})}),e("p",{children:"And, of course, we can also move camera 2 around:"})]}),n("div",{className:"body-text",children:[n("div",{children:[e("button",{className:"control-button",onClick:()=>q(s.setRotationToIdentity),children:"Set Rotation To Identity"}),e("button",{className:"control-button",onClick:()=>q(s.setLookPositionToOrigin),children:"Look At Origin"}),e("button",{className:"control-button",onClick:()=>q(s.resetTransforms),children:"Reset"})]}),n("div",{children:["Standard views: ",e("button",{className:"control-button",onClick:()=>q(s.useStandardViewX),children:"X Axis"}),e("button",{className:"control-button",onClick:()=>q(s.useStandardViewY),children:"Y Axis"}),e("button",{className:"control-button",onClick:()=>q(s.useStandardViewZ),children:"Z Axis"})]})]}),e("h2",{id:"stereo-camera-pair",className:"title-text",children:"Getting To Know Our Stereo Camera Pair"}),n("div",{className:"body-text",children:[n("p",{ref:ce,children:["Surprise! Here's yet ",e("em",{children:"another"})," camera. "]}),n("p",{children:["Don't worry, this one's just for reference (we'll call it the ",e("strong",{children:"witness camera"}),"); we won't use it in any calculations or anything."]}),e("p",{children:"Instead, we'll use it to take a look at what our cameras can see:"}),n("div",{children:[e("button",{className:"control-button",onClick:()=>_(h=>G($({},h),{c1Frustum:!h.c1Frustum})),children:u.c1Frustum?"Hide Camera 1's Frustum":"Show Camera 1's Frustum"}),e("button",{className:"control-button",onClick:()=>_(h=>G($({},h),{c2Frustum:!h.c2Frustum})),children:u.c2Frustum?"Hide Camera 2's Frustum":"Show Camera 2's Frustum"})]}),n("p",{children:["(You don't have to know this for CSCI 1430, but a camera's ",e("strong",{children:"frustum"})," is the shape which contains the region of space the camera can see)"]}),e("p",{children:"Before we move on, here's a reset button just in case:"}),e("div",{children:e("button",{className:"control-button",onClick:()=>Ee(s.resetTransforms),children:"Reset Witness Camera"})})]}),e("h2",{id:"camera-space-to-camera-space-transforms-prelude",className:"title-text",children:"Camera-Space to Camera-Space Transforms (Prelude)"}),e("div",{className:"body-text",children:n("blockquote",{children:[n("p",{children:["Think:  ","we've seen that can map a 3D world point to a 2D image point on a camera's image ","plane; but is it possible to map a 2D image point on one camera to a 2D image point ","on another? Why or why not? "]}),n("p",{children:["Hint:  ","is a 3D-to-2D mapping reversible?"]})]})}),n("div",{className:"body-text",children:[n("p",{children:["Since ",e("strong",{children:"epipolar geometry"})," is all about the relationship between two cameras,"," we typically begin by finding the ",e("strong",{children:"relative transformation"})," from c1's space to c2's space."]}),n("p",{children:[e("em",{children:e("strong",{children:"But wait:"})}),` what does a camera's "space" even mean, anyway? `]})]}),e("h2",{id:"camera-spaces",className:"title-text",children:"Camera Spaces"}),n("div",{className:"body-text",children:[n("p",{children:["Recall that ",e("a",{href:"#projection-recap",children:"when we talked about 2D image coordinates"}),", we used ",e("strong",{className:"blue",children:"x and y"}),`, and fixed z\xA0=\xA01, which just meant "it's on the image plane". `,e("em",{children:"But who's to say we can't have coordinates where z\xA0\u2260\xA01?"})]}),n("p",{children:["Here's c1's projection equation again, but only its first step (M\xA0*\xA0X). ","Here are also some controls for the 3D world point:"]}),n("div",{children:[e("button",{className:"control-button",onClick:()=>{le(!1),je(ie.setPointToOrigin)},children:"Set Point To Origin"}),e("button",{className:"control-button",onClick:()=>le(h=>!h),children:ee?"Stop Moving":"Start Moving"})]}),e("p",{children:"...as well as for camera 1:"}),n("div",{children:[e("button",{className:"control-button",onClick:()=>x(s.setRotationToIdentity),children:"Set c1's Rotation To Identity"}),e("button",{className:"control-button",onClick:()=>x(s.setLookPositionToOrigin),children:"Point c1 At Origin"}),e("button",{className:"control-button",onClick:()=>x(s.resetTransforms),children:"Reset c1"})]}),n("div",{children:["Standard views: ",e("button",{className:"control-button",onClick:()=>x(s.useStandardViewX),children:"X Axis"}),e("button",{className:"control-button",onClick:()=>x(s.useStandardViewY),children:"Y Axis"}),e("button",{className:"control-button",onClick:()=>x(s.useStandardViewZ),children:"Z Axis"})]})]}),n(w,{children:[e(y,{label:"intrinsic matrix, K",matrix:a}),e("span",{children:"*"}),e(z,{label:"extrinsic matrix, M",matrix:r,className:"blue last"}),e("span",{children:"*"}),e(Y,{label:"world coord, X",vector:t}),e("span",{className:"big",children:"="}),e(y,{label:"intrinsic matrix, K",matrix:a}),e("span",{children:"*"}),e(b,{label:"M * X",vector:N,className:"blue all"})]}),e("div",{className:"body-text",children:n("blockquote",{children:[n("p",{children:["Think:  ","what does the right-most column of the extrinsic matrix (M) represent, ",`in terms of the camera's "space"?`]}),n("p",{children:["Hint:  ","did you try setting the point to the ",e("em",{children:"origin"}),"?"]})]})}),n("div",{className:"body-text",children:[n("p",{children:[`Just this once, we're going to give you the answer to a "think" question: `,"the right-most column represents the position of the ",e("strong",{children:"world-space origin"})," in ",e("strong",{children:"camera space"}),"."]}),n("p",{children:["In fact, that relates to the whole ",e("em",{children:"point"})," of the ",e("strong",{children:"extrinsic matrix"}),": it takes a ",e("strong",{children:"3D"})," point in world space and maps it to a corresponding ",e("strong",{children:"3D"})," point ",e("strong",{children:"in camera space"}),"."]})]}),e("div",{className:"body-text",children:n("blockquote",{children:[n("p",{children:["By the way, since an extrinsic matrix is just a rotation and a translation, it is ",e("em",{children:e("strong",{children:"invertible"})}),"."]}),n("p",{children:["However, this doesn't mean that ",e("em",{children:e("strong",{children:"projection"})})," is invertible! Recall that you divide ","by z, and then toss that value away. That information is gone, so z could have been ","anything: this corresponds to any location along the ",e("strong",{children:"ray"})," going from the camera to the point."]})]})}),e("div",{className:"body-text",children:n("p",{children:["This was all you needed to know about coordinate spaces for CSCI 1430. ","Now, we're ready to talk about ",e("strong",{children:"camera-space to camera-space transforms"}),"."]})}),e("h2",{id:"camera-space-to-camera-space-transforms",className:"title-text",children:"Camera-Space to Camera-Space Transforms"}),e("div",{className:"body-text",children:n("p",{children:["As we just discussed, a 3D world-space coordinate X can be mapped to a ","3D camera-space coordinate by left-multiplying it by M:"]})}),n(w,{initialCollapse:!0,children:[e(z,{label:"M",matrix:r,className:"blue last"}),e("span",{children:"*"}),e(Y,{label:"X",vector:t}),e("span",{className:"big",children:"="}),e(b,{label:"camera 1 space coord",vector:N,className:"blue all"})]}),e("div",{className:"body-text",children:n("p",{children:["We want to rearrange this so that X is on the left-hand side. ","To do this, we will pretend that M is a ",e("strong",{children:"square matrix"})," with [0,\xA00,\xA00,\xA01] on the bottom row, so that we can take its ",e("em",{children:e("strong",{children:"inverse"})}),"."]})}),n(w,{initialCollapse:!0,children:[e(z,{label:"M (3 x 4)",matrix:r}),e("span",{className:"big",children:"\u2192"}),e(B,{label:"M (4 x 4)",matrix:r}),e("span",{className:"big",children:"\u2192"}),e(B,{label:"inverse of extrinsic matrix, M\u207B\xB9",matrix:j})]}),e("div",{className:"body-text",children:n("p",{children:["We'll also have to ",e("strong",{children:"homogenize"})," the camera space coordinate, by sticking a 1 on the bottom. ","Then, we can rearrange the earlier equation:"]})}),n(w,{initialCollapse:!0,children:[e(Y,{label:"X",vector:t}),e("span",{className:"big",children:"="}),e(B,{label:"M\u207B\xB9",matrix:j}),e("span",{children:"*"}),e(Y,{label:"camera 1 space coord",vector:N,className:"blue all"})]}),e("div",{className:"body-text",children:n("p",{children:["Now, if we want to get to ",e("strong",{children:"camera 2's"})," space, we can just left-multiply by ",n("strong",{children:[e("em",{children:"its"})," extrinsic matrix, M'"]}),"! (Note that we have to do the same trick to make M' 4\xA0x\xA04):"]})}),n(w,{initialCollapse:!0,children:[e(Y,{label:"camera 2 space coord",vector:f,className:"green all"}),e("span",{className:"big",children:"="}),e(B,{label:"M'",matrix:v}),e("span",{children:"*"}),e(B,{label:"M\u207B\xB9",matrix:j}),e("span",{children:"*"}),e(Y,{label:"camera 1 space coord",vector:N,className:"blue all"})]}),e("div",{className:"body-text",children:e("p",{children:"Finally, to make our lives easier, we can combine M' * M\u207B\xB9 into a single matrix:"})}),n(w,{children:[e(B,{label:"M'",matrix:v}),e("span",{children:"*"}),e(B,{label:"M\u207B\xB9",matrix:j}),e("span",{className:"big",children:"="}),e(B,{label:"camera 1 space to camera 2 space",matrix:C})]}),n("div",{className:"body-text",children:[n("p",{children:["As always, you're ",e("em",{children:"highly"})," encouraged to mess around with the positions of c1 and c2",". Watch how the above matrix changes!"]}),n("div",{children:[e("button",{className:"control-button",onClick:()=>x(s.setRotationToMatchC2),children:"Rotate c1 to match c2"}),e("button",{className:"control-button",onClick:()=>x(s.setPositionToMatchC2),children:"Translate c1 to match c2"}),e("button",{className:"control-button",onClick:()=>x(s.resetTransforms),children:"Reset c1"})]}),n("div",{children:[e("button",{className:"control-button",onClick:()=>q(s.setRotationToMatchC1),children:"Rotate c2 to match c1"}),e("button",{className:"control-button",onClick:()=>q(s.setPositionToMatchC1),children:"Translate c2 to match c1"}),e("button",{className:"control-button",onClick:()=>q(s.resetTransforms),children:"Reset c2"})]})]}),e("h2",{id:"relative-rotation-and-translation",className:"title-text",children:"Relative Rotation And Translation"}),n("div",{className:"body-text",children:[n("p",{children:['Like all coordinate transforms (mappings from one "space" to another), ',"the above matrix is really just a rotation combined with a translation. "]}),e("p",{children:"Let's try to break it apart, since we'll need the pieces later:"})]}),n(w,{children:[e("span",{children:"Break"}),e(B,{label:"c1 space to c2 space",matrix:C}),e("span",{children:"into"}),e(y,{label:"some kind of rotation, R",matrix:A,className:"brown all"}),e("span",{children:"and"}),e(b,{label:"some kind of translation, T",vector:V})]}),n("div",{className:"body-text",children:[e("p",{className:"brown",children:e("em",{children:"What does the thing on the left, R, mean?"})}),n("p",{children:["We can find out by giving both cameras the same position, but different ","rotations (you may have to click a few times):"]}),n("div",{children:[e("button",{className:"control-button",onClick:()=>x(s.setPositionToMatchC2),children:"Translate c1 to match c2"}),e("button",{className:"control-button",onClick:()=>x(s.setRotationToIdentity),children:"Set c1's Rotation To Identity"}),e("button",{className:"control-button",onClick:()=>x(s.resetTransforms),children:"Reset c1"})]})]}),n(w,{children:[e("span",{children:"Remember these guys? "}),e(z,{label:"camera 1's extrinsic matrix, M",matrix:r,className:"brown left"}),e("span",{children:"and"}),e(z,{label:"camera 2's extrinsic matrix, M'",matrix:v,className:"brown left"})]}),e("div",{className:"body-text",children:n("p",{children:["Observe that R is equal to the rotation part of M' when M has no rotation! ","From this, we might guess that R is ",e("span",{className:"brown",children:"a rotation which takes c1's direction and rotates it to match c2's"}),". Let's give it a proper label:"]})}),n(w,{children:[e("span",{children:"Break"}),e(B,{label:"c1 space to c2 space",matrix:C}),e("span",{children:"into"}),e(y,{label:"c1 space to c2 space rotation, R",matrix:A,className:"brown label"}),e("span",{children:"and"}),e(b,{label:"some kind of translation, T",vector:V,className:"purple all"})]}),n("div",{className:"body-text",children:[e("p",{className:"purple",children:e("em",{children:"Now, what does the thing on the right, T, mean?"})}),n("p",{children:["To figure this one out, ",e("strong",{children:"note"})," T's value. Then, rotate c1:"]}),n("div",{children:[e("button",{className:"control-button",onClick:()=>x(s.setRotationToMatchC2),children:"Rotate c1 to match c2"}),e("button",{className:"control-button",onClick:()=>x(s.setPositionToMatchC2),children:"Translate c1 to match c2"})]}),n("p",{children:["Did T change when you rotated c1? (Probably not!). ","Reset, and this time, try rotating c2 instead:"]}),n("div",{children:[e("button",{className:"control-button",onClick:()=>x(s.resetTransforms),children:"Reset c1"}),e("button",{className:"control-button",onClick:()=>q(s.resetTransforms),children:"Reset c2"})]}),n("div",{children:[e("button",{className:"control-button",onClick:()=>q(s.setRotationToMatchC1),children:"Rotate c2 to match c1"}),e("button",{className:"control-button",onClick:()=>x(s.setPositionToMatchC2),children:"Translate c1 to match c2"})]}),e("p",{children:"Did T change when you rotated c2? (Probably!)."}),n("p",{children:["As you've probably already guessed, T is ",e("span",{className:"purple",children:"a translation which takes c1 and moves it to c2. "}),"However, you might've also caught on to something more subtle: ",e("em",{className:"purple",children:"T is defined in camera 2's space!"})]}),e("p",{children:"We can now give T a proper label, too:"})]}),n(w,{children:[e("span",{children:"Break"}),e(B,{label:"c1 space to c2 space",matrix:C}),e("span",{children:"into"}),e(y,{label:"c1 space to c2 space rotation, R",matrix:A,className:"brown all label"}),e("span",{children:"and"}),e(b,{label:"c1 space to c2 space translation (in c2 space), T",vector:V,className:"purple all label"})]}),e("h2",{id:"uh-what-just-happened",className:"title-text",children:"Uh, What Just Happened?"}),n("div",{className:"body-text",children:[n("p",{children:["We just figured out that, given a transform which maps 3D coordinates in ",e("strong",{children:rt})," space to 3D coordinates in ",e("strong",{children:st})," space, we can break it into understandable pieces. "]}),n("p",{children:["Specifically, we can extract a ",n("span",{className:"brown",children:["rotation from ",e("strong",{children:Be})," space to ",e("strong",{children:De})," space, R"]}),", and a ",n("span",{className:"purple",children:["translation from ",e("strong",{children:Be})," space to ",e("strong",{children:De})," space, in ",e("strong",{children:De})," space, T"]}),"."]}),e("div",{children:e("button",{className:"control-button",onClick:()=>ot(h=>!h),children:"Say that again, but more "+(de?"specifically":"generally")})}),n("p",{children:["If you're lost, don't worry, it took ",e("em",{children:"us"})," >20h to figure this out \u{1F605}. ","The good news, though, is that we're on the home stretch!"]})]}),e("h2",{id:"the-essential-matrix",className:"title-text",children:"The Essential Matrix"}),e("div",{className:"body-text",children:n("p",{children:["As a matter of fact, once you have ",e("strong",{className:"brown",children:"R"})," and ",e("strong",{className:"purple",children:"T"}),", we can make the ",e("strong",{children:"essential matrix"})," just by following a simple recipe:"]})}),n(w,{children:[e("span",{children:'First, convert T into its "cross-product matrix form": '}),e(b,{label:"T",vector:V,className:"purple all label"}),e("span",{children:"\u2192"}),e(y,{label:"T_x",matrix:K,className:"purple all label"})]}),n(w,{children:[e("span",{children:"Then multiply!: "}),e(y,{label:"T_x",matrix:K,className:"purple all label"}),e("span",{children:"*"}),e(y,{label:"R",matrix:A,className:"brown all label"}),e("span",{className:"big",children:"="}),e(y,{label:"E",matrix:re})]}),n("div",{className:"body-text",children:[n("p",{children:["Great! Let's recap:",e("br",{}),"- We took M and M'",e("br",{}),"- Calculated a c1 space to c2 space transform",e("br",{}),"- Broke it apart to get R and T",e("br",{}),"- And finally calculated our essential matrix"]}),e("p",{children:"We're done here, right?"}),e("p",{children:"Right?"})]}),e("h2",{id:"the-fundamental-matrix",className:"title-text",children:"The Fundamental Matrix"}),n("div",{className:"body-text",children:[e("p",{children:"There's good news and bad news."}),n("p",{children:["The bad news is that we haven't considered our ",e("strong",{children:"intrinsic matrices, K and K'"}),". Since all we have are normalized image coordinates, we need to ",'"un-normalize" them, undoing the last multiplication-by-K in the ',"projection equation (repeated here):"]})]}),n(w,{children:[e(y,{label:"intrinsic matrix, K",matrix:a}),e("span",{children:"*"}),e(z,{label:"extrinsic matrix, M",matrix:r}),e("span",{children:"*"}),e(Y,{label:"world coord, X",vector:t}),e("span",{className:"big",children:"="}),e(b,{label:"result",vector:S}),e("span",{className:"big",children:"="}),e("span",{className:"limit-dp",children:P(S.z)}),e(b,{label:"image coord, x",vector:l,className:"blue"})]}),n("div",{className:"body-text",children:[n("p",{children:["We ",e("em",{children:"could"})," do this for every normalized image coordinate we use. However, that would be a pain. "]}),n("p",{children:['Instead, we can "sandwich" the essential matrix with the ',e("strong",{children:"inverses"})," of the intrinsic matrices, to make a ",e("strong",{children:"fundamental matrix"}),"."]})]}),n(w,{children:[e(y,{label:"transpose of the inverse of K', aka K'\u207B\u1D40",matrix:ge}),e("span",{children:"*"}),e(y,{label:"E",matrix:re}),e("span",{children:"*"}),e(y,{label:"the inverse of K, aka K\u207B\xB9",matrix:fe}),e("span",{className:"big",children:"="}),e(y,{label:"F",matrix:J})]}),e("div",{className:"body-text",children:n("blockquote",{children:[n("p",{children:["Aside: we just skipped over that, but note the placements of K and K'. Back when we calculated ",e("strong",{children:"c1 space to c2 space"}),', we assumed a certain "direction" in our transform, which affected R and T, and thus E.']}),n("p",{children:["Since ",e("strong",{children:"c1's"}),' space is the "',e("strong",{children:"input"}),'", we should apply our E to that; ',"therefore, c1's intrinsic matrix K (rather, its inverse) must be on the ",e("strong",{children:"right"})," side. "]}),n("p",{children:["Conversely, ",e("strong",{children:"c2's"})," intrinsic matrix K' (again, its inverse, then transpose, because of ","matrix multiplication rules) must be on the ",e("strong",{children:"left"})," side."]})]})}),e("div",{className:"body-text",children:n("p",{children:["We now have our ",e("strong",{children:"fundamental matrix"}),"! Let's test it out :)"]})}),e("h2",{id:"epipolar-lines",className:"title-text",children:"Epipolar Lines"}),n("div",{className:"body-text",children:[n("p",{children:["We've seen ",n("a",{href:"#projection-recap",children:["matrices that map ",e("em",{children:"3D world coordinates"})," to ",e("em",{children:"2D image coordinates"})]}),"."]}),n("p",{children:["We've also seen ",n("a",{href:"#camera-space-to-camera-space-transforms",children:["matrices that map ",e("em",{children:"3D coordinates in one space"})," to ",e("em",{children:"3D coordinates in a different space"})]}),"."]}),n("p",{children:["Compared to those, the essential and fundamental matrices are actually ","pretty unique: they map ",e("strong",{children:"points on one camera's image plane"})," to ",n("strong",{children:[e("em",{children:"lines"})," on another camera's image plane!"]})]}),n("p",{children:["These lines are known as ",e("strong",{children:"epipolar lines"}),", and they represent the places where a 2D point (on ",e("em",{children:"our"})," camera's image plane) corresponding to a 2D point (on ",e("em",{children:"the other"})," camera's image plane) can be found."]}),n("p",{children:["For a different perspective, an epipolar line can also be considered to be the ",e("strong",{children:"projection"})," of the line going through the other camera's center and the object, onto our ",`camera's image plane. Try enabling these "lines of sight" below:`]}),e("div",{children:e("button",{className:"control-button",onClick:()=>_(h=>G($({},h),{epipolarLines:!h.epipolarLines})),children:u.epipolarLines?"Hide Lines From Cameras To Object":"Show Lines From Cameras To Object"})})]}),e("div",{className:"body-text",children:n("blockquote",{children:[n("p",{children:["Think:  ",'why does the "line of sight" contain all the places where the corresponding point should ',"be found on our image plane?"]}),n("p",{children:["Hint:  ",'consider that every point along that "line of sight" will look the same to the other camera.']})]})}),n("div",{className:"body-text",children:[e("p",{children:"Do also enable the point predictions below, for some nice color-coding:"}),n("div",{children:[e("button",{className:"control-button",onClick:()=>_(h=>G($({},h),{c1PointPrediction:!h.c1PointPrediction})),children:u.c1PointPrediction?"Hide c1's Point Prediction":"Show c1's Point Prediction"}),e("button",{className:"control-button",onClick:()=>_(h=>G($({},h),{c2PointPrediction:!h.c2PointPrediction})),children:u.c1PointPrediction?"Hide c2's Point Prediction":"Show c2's Point Prediction"})]}),n("p",{children:["To get an epipolar line, left-multiply the point on the c1's image plane by F, ","or c2's by F\u1D40:"]})]}),n(w,{children:[e(y,{label:"F",matrix:J}),e("span",{children:"*"}),e(b,{label:"x",vector:l,className:"blue"}),e("span",{className:"big",children:"="}),e(b,{label:"l'",vector:I,className:"blue all"})]}),n(w,{children:[e(y,{label:"F\u1D40",matrix:g}),e("span",{children:"*"}),e(b,{label:"x'",vector:F,className:"green"}),e("span",{className:"big",children:"="}),e(b,{label:"l",vector:L,className:"green all"})]}),n("div",{className:"body-text",children:[e("p",{children:"The lines are represented in vector form, but they can be read:"}),n("p",{children:["l': ",e("span",{className:"blue",children:P(I.x)})," x + ",e("span",{className:"blue",children:P(I.y)})," y + ",e("span",{className:"blue",children:P(I.z)})," = 0"]}),n("p",{children:["l: ",e("span",{className:"green",children:P(L.x)})," x + ",e("span",{className:"green",children:P(L.y)})," y + ",e("span",{className:"green",children:P(L.z)})," = 0"]}),n("p",{children:["Here, we have a crude test (it only shows the y-intercepts on the left and right borders) ",'which checks if our calculated epipolar lines match up exactly with the "lines of sight":']}),e("div",{children:e("button",{className:"control-button",onClick:()=>_(h=>G($({},h),{epipolarLinePredictions:!h.epipolarLinePredictions})),children:u.epipolarLinePredictions?"Hide Epipolar Line Predictions":"Show Epipolar Line Predictions"})})]}),e("h2",{id:"epipolar-constraint",className:"title-text",children:"Epipolar Constraint"}),n("div",{className:"body-text",children:[e("p",{children:"Now that we have our epipolar lines, why stop there?"}),n("p",{children:["After all, the dot product of a line and a point on that line should return zero. ","So, if we have a ",e("strong",{children:"candidate point correspondence"})," we would like to check, we can use that to our advantage."]}),n("p",{children:["This is known as the ",e("strong",{children:"epipolar constraint"}),", and it usually looks something like this:"]})]}),n(w,{initialCollapse:!0,children:[e(b,{label:"x'",vector:F,className:"green"}),e("span",{children:"dot"}),e(y,{label:"F",matrix:J}),e("span",{children:"*"}),e(b,{label:"x",vector:l,className:"blue"}),e("span",{className:"big",children:"="}),e(b,{label:"x'",vector:F,className:"green"}),e("span",{children:"dot"}),e(b,{label:"l'",vector:I,className:"blue"}),e("span",{className:"big",children:"="}),e("span",{children:P(ve)})]}),e("div",{className:"body-text",children:e("p",{children:"Or like this:"})}),n(w,{initialCollapse:!0,children:[e(b,{label:"x",vector:l,className:"blue"}),e("span",{children:"dot"}),e(y,{label:"F\u1D40",matrix:g}),e("span",{children:"*"}),e(b,{label:"x'",vector:F,className:"green"}),e("span",{className:"big",children:"="}),e(b,{label:"x",vector:l,className:"blue"}),e("span",{children:"dot"}),e(b,{label:"l",vector:L,className:"green"}),e("span",{className:"big",children:"="}),e("span",{children:P(we)})]}),e("h2",{id:"conclusion",className:"title-text",children:"Conclusion"}),n("div",{className:"body-text",children:[e("p",{children:e("strong",{children:"Congratulations!"})}),e("p",{children:"You made it through the most challenging concept in CSCI 1430 :)"}),n("p",{children:["In this workshop, we used ",e("strong",{children:"known camera matrices"})," to get a fundamental matrix. Incidentally, this is just ",e("strong",{children:"one"})," way to do it, and probably the harder one!"]}),n("p",{children:["In HW3, you will implement a different way, one which involves ","using point correspondences to ",e("em",{children:"guess"})," the fundamental matrix, instead. You will probably use ",e("strong",{children:"linear least-squares regression"})," or ",e("strong",{children:"singular-value decomposition"}),"."]}),e("p",{children:"All the best!"})]})]})})})]})}It.render(e(Z.StrictMode,{children:e(hn,{})}),document.getElementById("root"));
