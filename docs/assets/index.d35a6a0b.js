var je=Object.defineProperty,He=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable;var ve=(t,n,a)=>n in t?je(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,ie=(t,n)=>{for(var a in n||(n={}))Oe.call(n,a)&&ve(t,a,n[a]);if(we)for(var a of we(n))Be.call(n,a)&&ve(t,a,n[a]);return t},ae=(t,n)=>He(t,Ve(n));import{M as Y,j as pe,R as _,a as re,V as y,Q as Xe,S as We,b as Ke,I as $e,c as Ge,d as Ye,P as _e,C as Ue,L as Ze,B as Qe,e as Je,W as et,O as tt,A as nt,f as xe,G as it,r as l,g as Ne,h as at}from"./vendor.bdc920a1.js";const rt=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const m of s.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}};rt();var B;(function(t){t[t.nothing=0]="nothing",t[t.setPointToOrigin=1]="setPointToOrigin"})(B||(B={}));var h;(function(t){t[t.nothing=0]="nothing",t[t.setLookPositionToOrigin=1]="setLookPositionToOrigin",t[t.setRotationToIdentity=2]="setRotationToIdentity",t[t.resetTransforms=3]="resetTransforms",t[t.useStandardViewX=4]="useStandardViewX",t[t.useStandardViewY=5]="useStandardViewY",t[t.useStandardViewZ=6]="useStandardViewZ"})(h||(h={}));const ot=5,st=/^(-?)0(\.)/;function I(t){if(typeof t=="string")return t;if(Math.abs(t)<1e-4)return"0";const a=(Math.round(t*1e3)/1e3).toString().replace(st,"$1$2"),r=Math.max(a.indexOf(".")+3,ot);return a.length>r?a.slice(0,r-1)+"\u2026":a.slice(0,r)}function ct(t){return new Y().fromArray([0,-t.z,t.y,t.z,0,-t.x,-t.y,t.x,0])}function Pe(t){const n=t.elements;return new Y().fromArray([n[0],n[1],n[2],n[4],n[5],n[6],n[8],n[9],-n[10],0,0,0])}function ke(t,n){return t.length===n.length&&t.every((a,r)=>a===n[r])}function lt(t,n,a){return Math.abs(t.x-n.x)<a&&Math.abs(t.y-n.y)<a&&Math.abs(t.z-n.z)<a&&Math.abs(t.w-n.w)<a}const e=pe.exports.jsx,i=pe.exports.jsxs,Me=pe.exports.Fragment;function oe({label:t,array:n,className:a,style:r}){return i("div",{className:"matrix "+a,children:[e("div",{className:"matrix-label",children:t}),e("div",{className:"matrix-elements",style:r,children:n.map((o,s)=>e("span",{className:"limit-dp",children:I(o)},s))})]})}function dt({label:t,matrix:n,className:a}){return e(oe,{label:t,array:n.elements,className:a,style:{gridTemplate:"repeat(4, 1fr) / repeat(4, auto)"}})}function ht(t,n){return t.label===n.label&&t.matrix.equals(n.matrix)}const X=_.memo(dt,ht);function ut({label:t,vector:n,className:a}){return e(oe,{label:t,array:n.toArray(),className:a,style:{gridTemplate:"repeat(4, 1fr) / auto"}})}function mt(t,n){return t.label===n.label&&t.vector.equals(n.vector)}const U=_.memo(ut,mt);function pt({label:t,matrix:n,className:a}){const r=n.elements,o=r.length===16?[r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10]]:r;return e(oe,{label:t,array:o,className:a,style:{gridTemplate:"repeat(3, 1fr) / repeat(3, auto)"}})}function xt(t,n){return t.label===n.label&&ke(t.matrix.elements,n.matrix.elements)}const g=_.memo(pt,xt);function bt({label:t,vector:n,className:a}){const r=n.toArray(),o=r.length===4?[r[0],r[1],r[2]]:r;return e(oe,{label:t,array:o,className:a,style:{gridTemplate:"repeat(3, 1fr) / auto"}})}function ft(t,n){return t.label===n.label&&ke(t.vector.toArray(),n.vector.toArray())}const N=_.memo(bt,ft);function yt({label:t,matrix:n,className:a}){const r=n.elements,o=[r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10],r[12],r[13],r[14]];return e(oe,{label:t,array:o,className:a,style:{gridTemplate:"repeat(3, 1fr) / repeat(4, auto)"}})}function gt(t,n){return t.label===n.label&&t.matrix.equals(n.matrix)}const q=_.memo(yt,gt),Ae=new y,Te=new re,be=new Xe;function wt(t){fe(t,t.camera.position),he(t,t.orbitControls.target)}function fe(t,n){t.targetPosition.copy(n)}function he(t,n){t.orbitControls.target.copy(n),t.targetLookPosition.copy(n)}function vt(t,n){for(const a of n.cameraData){const r=a.container.clientWidth,o=a.container.clientHeight;a.camera.aspect=r/o,a.camera.updateProjectionMatrix(),a.renderer.setSize(r,o)}}function Nt(t,n){const a=(t-n.prevTime)/1e3;n.prevTime=t;const r=n.pointPosition;n.isMoving?(r.y=2+Math.sin(t*.0015)*2,n.fixedPointPosition=null):n.fixedPointPosition!=null&&r.copy(n.fixedPointPosition);for(const o of n.cameraData){const s=o.camera,m=o.line,M=o.orbitControls;let x=!1,C=!1;const c=o.targetPosition;Ae.subVectors(s.position,c);const d=Ae.length();if(d>1e-4){x=!0,C=d>.1;const b=15*a;s.position.lerp(c,b),s.updateProjectionMatrix()}if(C)s.lookAt(o.targetLookPosition);else if(Te.lookAt(s.position,o.targetLookPosition,s.up),be.setFromRotationMatrix(Te),lt(s.quaternion,be,1e-4))x||M.update();else{const b=5*a;s.quaternion.slerp(be,b),s.updateProjectionMatrix()}const v=m.geometry.attributes.position.array,P=r.clone().sub(s.position),A=s.position.clone().add(P.clone().multiplyScalar(-1e3)),w=s.position.clone().add(P.clone().multiplyScalar(1e3));v[0]=A.x,v[1]=A.y,v[2]=A.z,v[3]=w.x,v[4]=w.y,v[5]=w.z,m.geometry.attributes.position.needsUpdate=!0}}const se=new We;se.showPanel(0);document.body.appendChild(se.dom);se.dom.style.zIndex="100000000000000";function Fe(t,n,a){n.nextFrameReq=requestAnimationFrame(r=>Fe(r,n)),se.begin(),vt(t,n),Nt(t,n),Pt(n),se.end()}function Pt(t){kt(t),Mt(t)}function kt(t){t.cameraData.forEach(({renderer:n,camera:a})=>{n.render(t.scene,a)})}function Mt(t){t.updateGUIFunction(t)}const At=6010245,Tt=33511;function Ft(t){const n=new Ke,a=new $e(.25),r=new Ge({color:15257272}),o=new Ye(a,r);o.layers.enableAll(),n.add(o);const s=[];for(let c=0;c<t.length;c++){const d=t[c].container,v=t[c].canvas,P=d.clientWidth,A=d.clientHeight,w=P/A,b=new _e(40,w,1e-4,1e4);b.position.fromArray(Re(c)),b.layers.set(c);const F=new Ue(b);F.layers.enableAll(),F.visible=!1,n.add(F);const D=new Ze({color:c?At:Tt}),L=[b.position,o.position],R=new Qe().setFromPoints(L),k=new Je(R,D);k.frustumCulled=!1,k.layers.enableAll(),k.layers.disable(c),k.visible=!1,n.add(k);const u=new et({canvas:v,alpha:!0});u.setPixelRatio(window.devicePixelRatio),u.setClearColor(16777215,0),u.setSize(P,A);const z=new tt(b,d),S={container:d,canvas:v,camera:b,renderer:u,cameraHelper:F,line:k,orbitControls:z,targetPosition:new y().copy(b.position),targetLookPosition:new y,extrinsicMatrix:b.matrixWorldInverse,intrinsicMatrix:b.projectionMatrix};z.addEventListener("change",()=>wt(S)),s.push(S)}const m=new nt(10);m.setColors(new xe(16711680),new xe(65280),new xe(255)),m.layers.enableAll(),n.add(m);const M=new it(5,5,16711680,8680812);M.layers.enableAll(),n.add(M);let x="dummy";return x={isMoving:!1,modifierFunctions:{enableMovement(c){x.isMoving=c},setPointPosition(c){c!=null&&(x.fixedPointPosition=c.clone())},showFrustum(c,d){s[c].cameraHelper.visible=d},showEpipolarLines(c){s.forEach(({line:d})=>d.visible=c)},setPosition(c,d){fe(s[c],d)},setLookPosition(c,d){he(s[c],d)},resetSetup(c){fe(s[c],new y().fromArray(Re(c))),he(s[c],new y)},setRotationToIdentity:c=>{const d=s[c],v=d.camera,P=d.orbitControls.getDistance(),A=new y(v.position.x,v.position.y,v.position.z-P);he(d,A)}},scene:n,pointPosition:o.position,fixedPointPosition:null,updateGUIFunction:c=>{},nextFrameReq:0,prevTime:0,cameraData:s},x}function Re(t){switch(t){case 0:return[5,5,20];case 1:return[30,20,10];case 2:return[30,60,30];default:return[0,0,0]}}function Rt(t,n,a,r,o,s){const m=Ft([{container:t,canvas:n},{container:a,canvas:r},{container:o,canvas:s}]);return m.nextFrameReq=requestAnimationFrame(M=>Fe(M,m)),m}function Z({x:t,y:n,className:a}){return e("div",{className:"target "+a,style:{transform:`translate(${-t*50}%, ${n*50}%) scale(0.04)`}})}function Se(t,n,a){switch(a){case h.setLookPositionToOrigin:{t.modifierFunctions.setLookPosition(n,new y);break}case h.setRotationToIdentity:{t.modifierFunctions.setRotationToIdentity(n);break}case h.resetTransforms:{t.modifierFunctions.resetSetup(n);break}case h.useStandardViewX:{t.modifierFunctions.setPosition(n,new y(10,0,0)),t.modifierFunctions.setLookPosition(n,new y);break}case h.useStandardViewY:{t.modifierFunctions.setPosition(n,new y(0,10,0)),t.modifierFunctions.setLookPosition(n,new y);break}case h.useStandardViewZ:{t.modifierFunctions.setPosition(n,new y(0,0,10)),t.modifierFunctions.setLookPosition(n,new y);break}}}function St({x:t,xp:n,lFunction:a,lpFunction:r,setX:o,isMoving:s,setK:m,setM:M,setC1Pos:x,showC1Display:C,setKp:c,setMp:d,setC2Pos:v,showC2Display:P,showC3Display:A,otherThingsToShow:w,sceneCommand:b,setSceneCommand:F,c1Command:D,setC1Command:L,c2Command:R,setC2Command:k}){const u=l.exports.useRef(),z=l.exports.useRef(),S=l.exports.useRef(),W=l.exports.useRef(),K=l.exports.useRef(),Q=l.exports.useRef(),J=l.exports.useRef();l.exports.useEffect(()=>{if(!(b===B.nothing||u.current==null)){switch(b){case B.setPointToOrigin:u.current.modifierFunctions.setPointPosition(new y)}F(B.nothing)}},[b]),l.exports.useEffect(()=>{D===h.nothing||u.current==null||(Se(u.current,0,D),L(h.nothing))},[D]),l.exports.useEffect(()=>{R===h.nothing||u.current==null||(Se(u.current,1,R),k(h.nothing))},[R]),l.exports.useEffect(()=>{u.current!=null&&u.current.modifierFunctions.enableMovement(s)},[s]),l.exports.useEffect(()=>{u.current!=null&&u.current.modifierFunctions.showFrustum(0,w.c1Frustum)},[w.c1Frustum]),l.exports.useEffect(()=>{u.current!=null&&u.current.modifierFunctions.showFrustum(1,w.c2Frustum)},[w.c2Frustum]),l.exports.useEffect(()=>{u.current!=null&&u.current.modifierFunctions.showEpipolarLines(w.epipolarLines)},[w.epipolarLines]);function $(T){const j=new Ne(T.pointPosition.x,T.pointPosition.y,T.pointPosition.z,1);o(p=>j.equals(p)?p:j);const ce=Pe(T.cameraData[0].intrinsicMatrix.clone()),H=T.cameraData[0].extrinsicMatrix.clone(),ee=T.cameraData[0].camera.position.clone();m(p=>ce.equals(p)?p:ce),M(p=>H.equals(p)?p:H),x(p=>ee.equals(p)?p:ee);const te=Pe(T.cameraData[1].intrinsicMatrix.clone()),G=T.cameraData[1].extrinsicMatrix.clone(),ue=T.cameraData[0].camera.position.clone();c(p=>te.equals(p)?p:te),d(p=>G.equals(p)?p:G),v(p=>ee.equals(p)?p:ue)}l.exports.useEffect(()=>{u.current=Rt(z.current,S.current,W.current,K.current,Q.current,J.current),u.current.updateGUIFunction=$,$(u.current)},[]);const E={opacity:0,pointerEvents:"none"};return i("div",{id:"demo-window",children:[e("div",{children:i("div",{className:"container",ref:z,style:C?{}:E,children:[e("canvas",{className:"canvas",ref:S}),w.c1PointPrediction?e(Z,{x:t.x,y:t.y,className:"blue"}):null,w.epipolarLinePredictions?i(Me,{children:[e(Z,{x:-1,y:a(-1),className:"green"}),e(Z,{x:1,y:a(1),className:"green"})]}):null,e("div",{className:"container-label",children:"Camera 1 (c1)"})]})}),e("div",{children:i("div",{className:"container",ref:W,style:P?{}:E,children:[e("canvas",{className:"canvas",ref:K}),w.c2PointPrediction?e(Z,{x:n.x,y:n.y,className:"green"}):null,w.epipolarLinePredictions?i(Me,{children:[e(Z,{x:-1,y:r(-1),className:"blue"}),e(Z,{x:1,y:r(1),className:"blue"})]}):null,e("div",{className:"container-label",children:"Camera 2 (c2)"})]})}),e("div",{children:i("div",{className:"container",ref:Q,style:A?{}:E,children:[e("canvas",{className:"canvas",ref:J}),e("div",{className:"container-label",children:"Witness Camera"})]})})]})}const ye=t=>{const n=l.exports.useRef(null),[a,r]=l.exports.useState(!1),o=s=>{var x;const[m]=s,M=((x=m.rootBounds)==null?void 0:x.top)||0;r(m.isIntersecting||m.boundingClientRect.top-M<0)};return l.exports.useEffect(()=>{const s=new IntersectionObserver(o,t);return n.current&&s.observe(n.current),()=>{n.current&&s.unobserve(n.current)}},[n,t]),[n,a]},qt=new re().fromArray(["a","e","i",0,"b","f","j",0,"c","g","k",0,"d","h","l",0]),Ct=new Y().fromArray(["fx",0,0,"s","fy",0,"u0","v0",1]),Dt=new re().fromArray(["r11","r21","r31",0,"r12","r22","r32",0,"r13","r23","r33",0,"tx","ty","tz",0]);function It(){const[t,n]=l.exports.useState(new Ne),[a,r]=l.exports.useState(new Y),[o,s]=l.exports.useState(new re),[m,M]=l.exports.useState(new y),x=t.clone().applyMatrix4(o),C=new y(x.x,x.y,x.z).applyMatrix3(a),c=C.clone().divideScalar(C.z),[d,v]=l.exports.useState(new Y),[P,A]=l.exports.useState(new re),[w,b]=l.exports.useState(new y),F=t.clone().applyMatrix4(P),D=new y(F.x,F.y,F.z).applyMatrix3(d),L=D.clone().divideScalar(D.z),R=o.clone().invert(),k=P.clone().multiply(R),u=new Y().setFromMatrix4(k),z=new y().setFromMatrixColumn(k,3),S=u.clone().transpose(),W=z.clone().multiplyScalar(-1).applyMatrix3(S),K=ct(W),Q=a.clone().invert().transpose(),J=d.clone().invert(),$=K.clone().multiply(S),E=Q.clone().multiply($).multiply(J),T=E.clone().transpose(),j=L.clone().applyMatrix3(E),ce=f=>(-j.z-j.x*f)/j.y,H=c.clone().applyMatrix3(T),ee=f=>(-H.z-H.x*f)/H.y,te=l.exports.useRef(),G={root:te.current,rootMargin:"0px",threshold:1},[ue,p]=ye(G),[qe,Ce]=ye(G),[De,Ie]=ye(G),[le,me]=l.exports.useState(!1),[ne,de]=l.exports.useState({c1PointPrediction:!1,c2PointPrediction:!1,c1Frustum:!1,c2Frustum:!1,epipolarLines:!1,epipolarLinePredictions:!1}),[Le,ge]=l.exports.useState(B.nothing),[ze,V]=l.exports.useState(h.nothing),[Ee,O]=l.exports.useState(h.nothing);return i("div",{className:"App",children:[e(St,{x:c,xp:L,lFunction:ce,lpFunction:ee,setX:n,isMoving:le,setK:r,setM:s,setC1Pos:M,showC1Display:p,setKp:v,setMp:A,setC2Pos:b,showC2Display:Ce,showC3Display:Ie,otherThingsToShow:ne,sceneCommand:Le,setSceneCommand:ge,c1Command:ze,setC1Command:V,c2Command:Ee,setC2Command:O}),e("div",{id:"scroll-outer",children:e("div",{ref:te,children:i("div",{id:"scroll-inner",children:[e("h1",{className:"title-text",children:"CSCI 1430: Fundamental Matrix Workshop"}),i("div",{className:"body-text",children:[i("p",{children:["Hello! In this workshop, we'll walk through how to go from ",e("strong",{children:"camera matrices"})," to the ",e("strong",{children:"fundamental matrix"})," and ",e("strong",{children:"epipolar lines"}),"."]}),i("p",{children:["Epipolar geometry is a challenging concept to nail down, ","so if you have any questions, please make sure to ask us TAs!"]})]}),e("h2",{id:"camera-matrices-recap",className:"title-text",children:"Camera Matrices (Recap)"}),e("div",{className:"body-text",children:i("p",{children:["In previous lectures, you learned that a pinhole camera can be described by its ",e("strong",{children:"projection"})," matrix, which is the product of its ",e("strong",{children:"intrinsic"})," and ",e("strong",{children:"extrinsic"})," matrices:"]})}),i("div",{className:"matrix-equation",children:[e(q,{label:"projection matrix",matrix:qt}),e("span",{className:"big",children:"="}),e(g,{label:"intrinsic matrix",matrix:Ct}),e("span",{children:"*"}),e(q,{label:"extrinsic matrix",matrix:Dt})]}),i("div",{className:"body-text",children:[i("p",{children:["Recall that the ",e("strong",{children:e("em",{children:"intrinsic"})})," matrix depends only on things ",e("em",{children:"intrinsic"})," to the camera, like its field of view."]}),i("p",{children:["Likewise, the ",e("strong",{children:e("em",{children:"extrinsic"})})," matrix depends only on the camera's ",e("em",{children:"extrinsic"})," properties: its rotation and position in space."]})]}),e("div",{className:"body-text",children:i("blockquote",{children:[i("p",{children:["Think:  ","using only the extrinsic matrix, can you determine the camera's ","position in world space? If yes, how?"]}),i("p",{children:["Hint:  ","it's not <tx, ty, tz>."]})]})}),e("h2",{id:"introducing-camera-1",className:"title-text",children:"Introducing: Camera 1"}),e("div",{className:"body-text",children:i("p",{children:["Now, let's look at an ",e("strong",{children:"interactive example"}),". Here, we've set up a scene with an object and a camera (we'll call this ",e("strong",{children:"camera 1"}),")."]})}),i("div",{className:"matrix-equation",ref:ue,children:[e("span",{children:"Camera 1 has"}),e(g,{label:"intrinsic matrix, K",matrix:a}),e("span",{children:", "}),e(q,{label:"extrinsic matrix, M",matrix:o}),e("span",{children:", and"}),e(N,{label:"position",vector:m})]}),i("div",{className:"body-text",children:[i("p",{children:["Move the camera, and see how its intrinsic and extrinsic matrices change. ","You can drag with one finger to rotate, drag with two fingers to pan, ","scroll to zoom, or click any of these buttons:"]}),i("p",{children:[e("button",{className:"control-button",onClick:()=>V(h.setRotationToIdentity),children:"Set Rotation To Identity"})," ",e("button",{className:"control-button",onClick:()=>V(h.setLookPositionToOrigin),children:"Look At Origin"})," ",e("button",{className:"control-button",onClick:()=>V(h.resetTransforms),children:"Reset"})]}),i("p",{children:["Standard views: ",e("button",{className:"control-button",onClick:()=>V(h.useStandardViewX),children:"X Axis"})," ",e("button",{className:"control-button",onClick:()=>V(h.useStandardViewY),children:"Y Axis"})," ",e("button",{className:"control-button",onClick:()=>V(h.useStandardViewZ),children:"Z Axis"})]})]}),e("div",{className:"body-text",children:e("blockquote",{children:i("p",{children:["Notice how the right-most column of M changes when you rotate the camera, ","even if you don't change its position."]})})}),e("h2",{id:"projection-recap",className:"title-text",children:"Projection (Recap)"}),i("div",{className:"body-text",children:[i("p",{children:["If you've done the written component of HW3, you'd already have ",e("strong",{children:"projected"})," points in world space onto an image plane. ","If not, that's okay! We'll briefly recap the basic principles here :)"]}),i("p",{children:["Using camera 1 as an example, let's project the point located at ",e("strong",{children:`<${I(t.x)},\xA0${I(t.y)},\xA0${I(t.z)}>`})," onto our image plane."]})]}),i("div",{className:"matrix-equation",children:[e(g,{label:"intrinsic matrix, K",matrix:a}),e("span",{children:"*"}),e(q,{label:"extrinsic matrix, M",matrix:o}),e("span",{children:"*"}),e(U,{label:"world coord, X",vector:t}),e("span",{className:"big",children:"="}),e(N,{label:"result",vector:C}),e("span",{className:"big",children:"="}),e("span",{className:"limit-dp",children:I(C.z)}),e(N,{label:"image coord, x",vector:c,className:"blue"})]}),i("div",{className:"body-text",children:[i("p",{children:["This equation may seem scary, but it's lot simpler when you recall the steps for projection: ",e("br",{}),"1. Multiply K * M * X to get a 3x1 result",e("br",{}),"2. Then, divide that result by its z component",e("br",{}),"3. Finally, the result's ",e("strong",{className:"blue",children:"x and y values"})," give the point's normalized* coordinates on the image plane."]}),i("p",{children:["Now that we've calculated where the point should be, let's see if our prediction is correct. ","Click the button below to show a ",e("strong",{className:"blue",children:"marker"})," on the image: "]}),e("p",{children:e("button",{className:"control-button",onClick:()=>de(f=>ae(ie({},f),{c1PointPrediction:!f.c1PointPrediction})),children:ne.c1PointPrediction?"Hide Camera 1's Point Prediction":"Show Camera 1's Point Prediction"})})]}),i("div",{className:"body-text",children:[i("p",{children:["Try moving the camera around again! Or, click the button below to make the point ",le?"stop moving":"start moving",":"]}),e("p",{children:e("button",{className:"control-button",onClick:()=>me(f=>!f),children:le?"Stop Moving":"Start Moving"})})]}),e("div",{className:"body-text",children:i("blockquote",{children:[i("p",{children:["Think:  ","why are x and y axes flipped, resulting in <1,\xA01> being at the bottom left?"]}),i("p",{children:["Hint 1:  ","in our ",e("em",{children:"result"}),", z is +1. If the camera looks in the \u2011z direction, ","where is the image plane relative to the camera center?"]}),i("p",{children:["Hint 2:  ",'have you ever been told that the images on your retinas (in your eyes) are "inverted"? ','Remember when you had to "invert" kernels for convolution? ']})]})}),e("h2",{id:"introducing-camera-2",className:"title-text",children:"Introducing: Camera 2"}),e("div",{className:"body-text",children:i("p",{children:["Now that we're through the recaps, it's finally time to talk about ",e("strong",{children:"stereo camera pairs"}),". For that, let's introduce ",e("strong",{children:"camera 2"}),"!"]})}),i("div",{className:"matrix-equation",ref:qe,children:[e("span",{children:"Camera 2 has"}),e(g,{label:"intrinsic matrix, Kp",matrix:d}),e("span",{children:", "}),e(q,{label:"extrinsic matrix, Mp",matrix:P}),e("span",{children:", and"}),e(N,{label:"position",vector:w})]}),e("div",{className:"body-text",children:i("p",{children:["Just like we did with camera 1, we can project the point located at ",e("strong",{children:`<${I(t.x)},\xA0${I(t.y)},\xA0${I(t.z)}>`})," onto camera 2's image plane:"]})}),i("div",{className:"matrix-equation",children:[e(g,{label:"intrinsic matrix, K'",matrix:d}),e("span",{children:"*"}),e(q,{label:"extrinsic matrix, M'",matrix:P}),e("span",{children:"*"}),e(U,{label:"world coord, X",vector:t}),e("span",{className:"big",children:"="}),e(N,{label:"result",vector:D}),e("span",{className:"big",children:"="}),e("span",{className:"limit-dp",children:I(D.z)}),e(N,{label:"image coord, x'",vector:L,className:"green"})]}),i("div",{className:"body-text",children:[e("p",{children:e("button",{className:"control-button",onClick:()=>de(f=>ae(ie({},f),{c2PointPrediction:!f.c2PointPrediction})),children:ne.c2PointPrediction?"Hide Camera 2's Point Prediction":"Show Camera 2's Point Prediction"})}),e("p",{children:"And, of course, we can also move camera 2 around:"})]}),i("div",{className:"body-text",children:[i("p",{children:[e("button",{className:"control-button",onClick:()=>O(h.setRotationToIdentity),children:"Set Rotation To Identity"})," ",e("button",{className:"control-button",onClick:()=>O(h.setLookPositionToOrigin),children:"Look At Origin"})," ",e("button",{className:"control-button",onClick:()=>O(h.resetTransforms),children:"Reset"})]}),i("p",{children:["Standard views: ",e("button",{className:"control-button",onClick:()=>O(h.useStandardViewX),children:"X Axis"})," ",e("button",{className:"control-button",onClick:()=>O(h.useStandardViewY),children:"Y Axis"})," ",e("button",{className:"control-button",onClick:()=>O(h.useStandardViewZ),children:"Z Axis"})]})]}),e("h2",{id:"stereo-camera-pair",className:"title-text",children:"Getting To Know Our Stereo Camera Pair"}),i("div",{className:"body-text",children:[i("p",{ref:De,children:["Surprise! Here's yet ",e("em",{children:"another"})," camera. "]}),i("p",{children:["This one's just for reference (we'll call it the ",e("strong",{children:"witness"}),"), so we won't be using it in any calculations or anything."]}),e("p",{children:"Let's use it to take a look at what our cameras can see:"}),i("p",{children:[e("button",{className:"control-button",onClick:()=>de(f=>ae(ie({},f),{c1Frustum:!f.c1Frustum})),children:ne.c1Frustum?"Hide Camera 1's Frustum":"Show Camera 1's Frustum"})," ",e("button",{className:"control-button",onClick:()=>de(f=>ae(ie({},f),{c2Frustum:!f.c2Frustum})),children:ne.c2Frustum?"Hide Camera 2's Frustum":"Show Camera 2's Frustum"})]}),i("p",{children:["(You don't have to know this for CV, but a camera's ",e("strong",{children:"frustum"})," is the shape which contains the region of space the camera can see)"]})]}),e("h2",{id:"camera-to-camera-transforms-prelude",className:"title-text",children:"Camera-to-Camera Transforms (Prelude)"}),e("div",{className:"body-text",children:i("blockquote",{children:[i("p",{children:["Think:  ","we've seen that can map a 3D world coordinate to a 2D point on either camera; ","but is it possible to map a 2D point on one camera to a 2D point on another? ","Why or why not? "]}),i("p",{children:["Hint:  ","is a 3D-to-2D mapping reversible?"]})]})}),i("div",{className:"body-text",children:[i("p",{children:["Since ",e("strong",{children:"epipolar geometry"})," is all about the relationship between two cameras,"," we typically begin by finding the ",e("strong",{children:"relative transformation"})," from c1's space to c2's space."]}),i("p",{children:[e("em",{children:e("strong",{children:"But wait:"})}),` what does a camera's "space" even mean, anyway? `]})]}),e("h2",{id:"camera-spaces",className:"title-text",children:"Camera Spaces"}),i("div",{className:"body-text",children:[i("p",{children:["Recall that ",e("a",{href:"#projection-recap",children:"when we talked about 2D image coordinates"}),", we used ",e("strong",{className:"blue",children:"x and y"}),`, and fixed z\xA0=\xA01, which just meant "it's on the image plane". `,e("em",{children:"But who's to say we can't have coordinates where z\xA0\u2260\xA01?"})]}),i("p",{children:["Here's c1's projection equation again, but only its first step (M\xA0*\xA0X). ","Here are also some controls for the point:"]}),i("p",{children:[e("button",{className:"control-button",onClick:()=>{me(!1),ge(B.setPointToOrigin)},children:"Set Point To Origin"})," ",e("button",{className:"control-button",onClick:()=>me(f=>!f),children:le?"Stop Moving":"Start Moving"})]})]}),i("div",{className:"matrix-equation",children:[e(g,{label:"intrinsic matrix, K",matrix:a}),e("span",{children:"*"}),e(q,{label:"extrinsic matrix, M",matrix:o,className:"blue last"}),e("span",{children:"*"}),e(U,{label:"world coord, X",vector:t}),e("span",{className:"big",children:"="}),e(g,{label:"intrinsic matrix, K",matrix:a}),e("span",{children:"*"}),e(N,{label:"M * X",vector:x,className:"blue all"})]}),e("div",{className:"body-text",children:i("blockquote",{children:[i("p",{children:["Think:  ","what does the right-most column of the extrinsic matrix (M) represent, ",`in terms of the camera's "space"?`]}),i("p",{children:["Hint:  ","did you try setting the point to the ",e("em",{children:"origin"}),"?"]})]})}),i("div",{className:"body-text",children:[i("p",{children:[`For the first time, we're going to give you an answer to a "think" question: `,"the right-most column represents the ",e("strong",{children:"world-space origin"})," in ",e("strong",{children:"camera space"}),"."]}),i("p",{children:["In fact, that's the whole point of the ",e("strong",{children:"extrinsic matrix"}),"! It takes ",e("em",{children:"any"})," point in world space and maps it to a corresponding point ",e("strong",{children:"in camera space"}),"."]})]}),e("div",{className:"body-text",children:i("blockquote",{children:[i("p",{children:["By the way, since an extrinsic matrix is just a rotation and a translation, it is ",e("em",{children:e("strong",{children:"invertible"})}),"."]}),i("p",{children:["However, this doesn't mean that ",e("em",{children:e("strong",{children:"projection"})})," is invertible! Recall that you divide ","by z, and then toss that value away. That information is gone, so z could have been anything"]}),i("p",{children:["Think:  ","if you fix just 2 of 3 dimensions, what kind of shape do you get?"]})]})}),e("div",{className:"body-text",children:i("p",{children:["This was all you need to know about coordinate spaces for CV. ","We're now ready to talk about ",e("strong",{children:"camera-to-camera transforms"}),"."]})}),e("h2",{id:"camera-to-camera-transforms",className:"title-text",children:"Camera-to-Camera Transforms"}),e("div",{className:"body-text",children:i("p",{children:["As we just discussed, a world-space coordinate X can be mapped to a ","camera-space coordinate by left-multiplying it by M:"]})}),i("div",{className:"matrix-equation",children:[e(q,{label:"extrinsic matrix, M",matrix:o,className:"blue last"}),e("span",{children:"*"}),e(U,{label:"world coord, X",vector:t}),e("span",{className:"big",children:"="}),e(N,{label:"camera 1 space coord",vector:x,className:"blue all"})]}),e("div",{className:"body-text",children:i("p",{children:["We want to re-arrange this to have X on the left-hand side. ","To do this, we will pretend that M is a ",e("strong",{children:"square matrix"})," with [0,\xA00,\xA00,\xA01] on the bottom row, so that we can take its ",e("em",{children:e("strong",{children:"inverse"})}),"."]})}),i("div",{className:"matrix-equation",children:[e(q,{label:"extrinsic matrix, M",matrix:o}),e("span",{className:"big",children:"->"}),e(X,{label:"extrinsic matrix, M",matrix:o}),e("span",{className:"big",children:"->"}),e(X,{label:"inverse of extrinsic matrix, M\u207B\xB9",matrix:R})]}),e("div",{className:"body-text",children:e("p",{children:"Now, we can rearrange the earlier equation:"})}),i("div",{className:"matrix-equation",children:[e(U,{label:"world coord, X",vector:t}),e("span",{className:"big",children:"="}),e(X,{label:"inverse of extrinsic matrix, M\u207B\xB9",matrix:R}),e("span",{children:"*"}),e(N,{label:"camera 1 space coord",vector:x,className:"blue all"})]}),e("div",{className:"body-text",children:i("p",{children:["Then, if we wanted to get to ",e("strong",{children:"camera 2's"})," space, we could just left-multiply by ",i("strong",{children:[e("em",{children:"its"})," extrinsic matrix, M'"]}),". Note that we have to do the same trick to make M' 4\xA0x\xA04:"]})}),i("div",{className:"matrix-equation",children:[e(U,{label:"camera 2 space coord",vector:F,className:"green all"}),e("span",{className:"big",children:"="}),e(X,{label:"M'",matrix:P}),e("span",{children:"*"}),e(X,{label:"M\u207B\xB9",matrix:R}),e("span",{children:"*"}),e(N,{label:"camera 1 space coord",vector:x,className:"blue all"})]}),e("div",{className:"body-text",children:e("p",{children:"Finally, to make our lives easier, we can combine M' * M\u207B\xB9 into a single matrix:"})}),i("div",{className:"matrix-equation",children:[e(q,{label:"M'",matrix:P}),e("span",{children:"*"}),e(q,{label:"M\u207B\xB9",matrix:R}),e("span",{className:"big",children:"="}),e(X,{label:"camera 1 space to camera 2 space",matrix:k})]}),e("h2",{id:"relative-rotation-and-translation",className:"title-text",children:"Relative Rotation And Translation"}),e("div",{className:"body-text",children:i("p",{children:["Next, let's break the above matrix apart. We define these parts as "," weird math expressions, but it will make more sense later!"]})}),i("div",{className:"matrix-equation",children:[e("span",{children:" break "}),e(X,{label:"camera 1 space to camera 2 space",matrix:k}),e("span",{children:" into "}),e(g,{label:"left side, defined as R\u1D40",matrix:S}),e("span",{children:" and "}),e(N,{label:"right side, defined as -(R\u1D40 * T)",vector:z})]}),i("div",{className:"matrix-equation",children:[e("span",{children:"From R\u1D40 and -(R\u1D40 * T), we can then get "}),e(g,{label:"R",matrix:S}),e("span",{children:" and "}),e(N,{label:"T",vector:W})]}),i("div",{className:"body-text",children:[i("p",{children:["Think:  ","what exactly do ",e("strong",{children:"R"})," and ",e("strong",{children:"T"})," represent, and what's up with the -(R\u1D40 * T) on the right side?"]}),e("p",{children:e("strong",{children:"Explanation (click to expand):"})}),i("p",{children:["Imagine both cameras shared the same world position, but differed in rotation. Then, ","R\u1D40 would take camera 1's (c1's) direction and rotate it to match camera 2's (c2's). ","Thus, R\u1D40 is ",e("strong",{children:"the rotation from c1 to c2"}),", and since transposition is the same as inversion for rotation matrices, R is ",e("strong",{children:"the rotation from c2 to c1"}),"."]}),i("p",{children:["Now, imagine they have different world positions as well. ","R\u1D40 again rotates c1 to be parallel to c2. ","But now, to move c1 to perfectly match c2, ","we need to translate it by some vector ",e("em",{children:"in c2's space"}),": this is -(R\u1D40 * T), ",e("strong",{children:"the translation from c1 to c2, in c2's space"}),"."]}),i("p",{children:["On the flip side, T is ",e("strong",{children:"the translation from c2 to c1, in c1's space"}),"."]})]}),i("div",{className:"body-text",children:[i("p",{children:[e("strong",{children:"Whew!"})," That was a lot to get through!"]}),i("p",{children:["Don't worry, it took me >20h to figure this out, ","and you don't have to totally understand this for HW3."]}),i("p",{children:["But now, ",e("strong",{children:"given R and T"}),", we can finally make the ",e("strong",{children:"essential matrix"}),"! Just follow the recipe:"]})]}),i("div",{className:"matrix-equation",children:[e("span",{children:"First, convert T into its cross-product matrix form: "}),e(N,{label:"T",vector:W}),e("span",{children:"=>"}),e(g,{label:"T_x",matrix:K})]}),i("div",{className:"matrix-equation",children:[e("span",{children:"Then multiply!: "}),e(g,{label:"T_x",matrix:K}),e("span",{children:"*"}),e(g,{label:"R",matrix:S}),e("span",{className:"big",children:"="}),e(g,{label:"E",matrix:$})]}),e("div",{className:"body-text",children:i("p",{children:["The essential matrix is great for ",e("strong",{children:"canonical cameras"}),", with K = identity, but we have non-canonical cameras here. So, we must instead get the ",e("strong",{children:"fundamental matrix"}),":"]})}),i("div",{className:"matrix-equation",children:[e(g,{label:"K\u207B\u1D40",matrix:Q}),e("span",{children:"*"}),e(g,{label:"E",matrix:$}),e("span",{children:"*"}),e(g,{label:"K'\u207B\xB9",matrix:J}),e("span",{className:"big",children:"="}),e(g,{label:"F",matrix:E})]}),e("div",{className:"body-text",children:i("p",{children:["And with that, we can finally make ",e("strong",{children:"epipolar lines"}),"! ","Those are what I'm using to position the circles on the sides of the images above."]})}),i("div",{className:"matrix-equation",children:[e(g,{label:"F",matrix:E}),e("span",{children:"*"}),e(N,{label:"x'",vector:L,className:"green"}),e("span",{className:"big",children:"="}),e(N,{label:"l",vector:j,className:"green all"})]}),i("div",{className:"matrix-equation",children:[e(g,{label:"F\u1D40",matrix:T}),e("span",{children:"*"}),e(N,{label:"x",vector:c,className:"blue"}),e("span",{className:"big",children:"="}),e(N,{label:"l'",vector:H,className:"blue all"})]}),i("div",{className:"body-text",children:[i("p",{children:[e("strong",{children:"Congratulations!"}),e("br",{}),"You made it through the most difficult concept in CSCI 1430 :)"]}),i("p",{children:["As you saw above, we used ",e("strong",{children:"known camera matrices"})," to get a fundamental matrix. This is just ",e("strong",{children:"one"})," way to do it, and probably the harder one."]}),i("p",{children:["In HW3, you will implement a different way, one which involves ","using point correspondences to ",e("em",{children:"guess"})," the fundamental matrix, instead. All the best!"]})]})]})})})]})}at.render(e(_.StrictMode,{children:e(It,{})}),document.getElementById("root"));
